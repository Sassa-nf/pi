
```
H = |1  1| * _1____
    |1 -1|   sqrt(2)

X = |0 1|
    |1 0|

Z = |1  0|
    |0 -1|


show that H--*--H     --x--
             |    <=>   |
          H--x--H     --*--

     |1 0 0 0|     |a| (x) |c| = |a * c|
CX = |0 1 0 0|     |b|     |d|   |a * d|
     |0 0 0 1|                   |b * c|
     |0 0 1 0|                   |b * d|

                    |1  1  1  1|    1
|1  1| (x) |1  1| = |1 -1  1 -1|* -----
|1 -1|     |1 -1|   |1  1 -1 -1|    2
                    |1 -1 -1  1|

                             |1  1  1  1|   |1 0 0 0|   |1  1  1  1|     1     |1  1  1  1|   |1  1  1  1|     1     |4  0  0  0|     1     |1 0 0 0|
(H (x) H) * CX * (H (x) H) = |1 -1  1 -1| * |0 1 0 0| * |1 -1  1 -1| * ----- = |1 -1 -1  1| * |1 -1  1 -1| * ----- = |0  0  0  4| * ----- = |0 0 0 1|
                             |1  1 -1 -1|   |0 0 0 1|   |1  1 -1 -1|     4     |1  1 -1 -1|   |1  1 -1 -1|     4     |0  0  4  0|     4     |0 0 1 0|
                             |1 -1 -1  1|   |0 0 1 0|   |1 -1 -1  1|           |1 -1  1 -1|   |1 -1 -1  1|           |0  4  0  0|           |0 1 0 0|
```

Deutsch-Josza

```

|0> --H--*--H-- = f(0) + f(1)
         |
|1> --H--f--H-- |1>

Cf gate (control-f, so to speak)
x --*-- x
    |
y --f-- y+f(x)

                         |1  1  1  1|   |1-f(0)   f(0)      0      0|   |1  1  1  1|     1     |1             1        1        1|   |1  1  1  1|     1
(H x H) * Cf * (H x H) = |1 -1  1 -1| * |  f(0) 1-f(0)      0      0| * |1 -1  1 -1| * ----- = |1-2f(0) 2f(0)-1  1-2f(1)  2f(1)-1| * |1 -1  1 -1| * ----- =
                         |1  1 -1 -1|   |     0      0 1-f(1)   f(1)|   |1  1 -1 -1|     4     |1             1       -1       -1|   |1  1 -1 -1|     4
                         |1 -1 -1  1|   |     0      0   f(1) 1-f(1)|   |1 -1 -1  1|           |1-2f(0) 2f(0)-1  2f(1)-1  1-2f(1)|   |1 -1 -1  1|

                         |4             0       0             0|     1     |1           0 0           0|
                       = |0 4-4f(0)-4f(1)       0   4f(1)-4f(0)| * ----- = |0 1-f(0)-f(1) 0   f(1)-f(0)| -- well, you can see the function is computed for all
                         |0             0       4             0|     4     |0           0 1           0| -- inputs; but when done in real hardware, the "function"
                         |0   4f(1)-4f(0)       0 4-4f(0)-4f(1)|           |0   f(1)-f(0) 0 1-f(0)-f(1)| -- is computed once
```


Entanglement of Alice's qubit by Eve in BB84:

```
                   |1 0 0 0|   |1|   |1|
CX * |1| (x) |1| = |0 1 0 0| * |0| = |0|
     |0|     |0|   |0 0 0 1|   |0|   |0|
                   |0 0 1 0|   |0|   |0|

or

                   |1 0 0 0|   |0|   |0|
CX * |0| (x) |1| = |0 1 0 0| * |0| = |0|
     |1|     |0|   |0 0 0 1|   |1|   |0|
                   |0 0 1 0|   |0|   |1|

works.

Now, suppose Alice sends a bit in |+> basis:

(+ == 1/sqrt(2))

Alice sends |+>:
                   |1 0 0 0|   |+|   |+|
CX * |+| (x) |1| = |0 1 0 0| * |0| = |0|
     |+|     |0|   |0 0 0 1|   |+|   |0|
                   |0 0 1 0|   |0|   |+|

Alice sends |->:
                   |1 0 0 0|   |+|   |+|
CX * |+| (x) |1| = |0 1 0 0| * |0| = |0|
     |-|     |0|   |0 0 0 1|   |-|   |0|
                   |0 0 1 0|   |0|   |-|

Bob measures in |+> basis, too, which is the same as Bob applying Hadamard gate to the first bit, but I to the second:

          |+ 0 + 0|
H (x) I = |0 + 0 +|
          |+ 0 - 0|
          |0 + 0 -|

|+ 0 + 0|   |+|   | 0.5|
|0 + 0 +| * |0| = | 0.5|
|+ 0 - 0|   |0|   | 0.5|
|0 + 0 -|   |+|   |-0.5|

|+ 0 + 0|   |+|   | 0.5|
|0 + 0 +| * |0| = |-0.5|
|+ 0 - 0|   |0|   | 0.5|
|0 + 0 -|   |-|   | 0.5|

Now Bob does not get the same bit as Alice - in half the cases it will be the opposite (so can be detected: decryption
won't work).

Eve applies I (x) H to the pair that has collapsed through Bob's measurement to 0:

|+ + 0 0|   |+|   |1|
|+ - 0 0| * |+| = |0|
|0 0 + +|   |0|   |0|
|0 0 + -|   |0|   |0|

Eve applies I (x) H to the pair that has collapsed through Bob's measurement to 1:

|+ + 0 0|   |0|   |0|
|+ - 0 0| * |0| = |0|
|0 0 + +|   |+|   |0|
|0 0 + -|   |-|   |1|
```

```
e  = e^(i*pi/4);   e * e = cos(pi/2) + i*sin(pi/2) = i
-e = e^(-i*pi/4); (-e)*(-e) = -i;   -e * e = 1

T = |1  0|   T' = |1  0|
    |0  e|        |0 -e|

*    ---------------*----------------*-------*-- T ---*--
* == ------*--------|-------*--------|-- T - x - T' - x -
x    - H - x - T' - x - T - x - T' - x - T - H ----------


      -------*------
TXT = -------|------
      - T' - x - T -

|1  0 0  0 0  0 0  0|   |1 0 0 0 0 0 0 0|   |1 0 0 0 0 0 0 0|   |1  0 0  0  0 0  0 0|   |1 0 0 0 0 0 0 0|   |1 0 0 0  0 0  0 0|
|0 -e 0  0 0  0 0  0|   |0 1 0 0 0 0 0 0|   |0 e 0 0 0 0 0 0|   |0 -e 0  0  0 0  0 0|   |0 e 0 0 0 0 0 0|   |0 1 0 0  0 0  0 0|
|0  0 1  0 0  0 0  0|   |0 0 1 0 0 0 0 0|   |0 0 1 0 0 0 0 0|   |0  0 1  0  0 0  0 0|   |0 0 1 0 0 0 0 0|   |0 0 1 0  0 0  0 0|
|0  0 0 -e 0  0 0  0| * |0 0 0 1 0 0 0 0| * |0 0 0 e 0 0 0 0| = |0  0 0 -e  0 0  0 0| * |0 0 0 e 0 0 0 0| = |0 0 0 1  0 0  0 0|
|0  0 0  0 1  0 0  0|   |0 0 0 0 0 1 0 0|   |0 0 0 0 1 0 0 0|   |0  0 0  0  0 1  0 0|   |0 0 0 0 1 0 0 0|   |0 0 0 0  0 e  0 0|
|0  0 0  0 0 -e 0  0|   |0 0 0 0 1 0 0 0|   |0 0 0 0 0 e 0 0|   |0  0 0  0 -e 0  0 0|   |0 0 0 0 0 e 0 0|   |0 0 0 0 -e 0  0 0|
|0  0 0  0 0  0 1  0|   |0 0 0 0 0 0 0 1|   |0 0 0 0 0 0 1 0|   |0  0 0  0  0 0  0 1|   |0 0 0 0 0 0 1 0|   |0 0 0 0  0 0  0 e|
|0  0 0  0 0  0 0 -e|   |0 0 0 0 0 0 1 0|   |0 0 0 0 0 0 0 e|   |0  0 0  0  0 0 -e 0|   |0 0 0 0 0 0 0 e|   |0 0 0 0  0 0 -e 0|

            -----|     |
ICX * TXT = --*--| TXT |
            - x -|     |

|1 0 0 0        |   |1 0 0 0  0 0  0 0|   |1 0 0 0  0 0  0 0|
|0 1 0 0        |   |0 1 0 0  0 0  0 0|   |0 1 0 0  0 0  0 0|
|0 0 0 1        |   |0 0 1 0  0 0  0 0|   |0 0 0 1  0 0  0 0|
|0 0 1 0        | * |0 0 0 1  0 0  0 0| = |0 0 1 0  0 0  0 0|
|        1 0 0 0|   |0 0 0 0  0 e  0 0|   |0 0 0 0  0 e  0 0|
|        0 1 0 0|   |0 0 0 0 -e 0  0 0|   |0 0 0 0 -e 0  0 0|
|        0 0 0 1|   |0 0 0 0  0 0  0 e|   |0 0 0 0  0 0 -e 0|
|        0 0 1 0|   |0 0 0 0  0 0 -e 0|   |0 0 0 0  0 0  0 e|

ICX * TXT * ICX * TXT

|1 0 0 0          |   |1 0 0 0          |   |1 0 0 0         |
|0 1 0 0          |   |0 1 0 0          |   |0 1 0 0         |
|0 0 0 1          |   |0 0 0 1          |   |0 0 1 0         |
|0 0 1 0          | * |0 0 1 0          | = |0 0 0 1         |
|         0 e  0 0|   |         0 e  0 0|   |        1 0  0 0|
|        -e 0  0 0|   |        -e 0  0 0|   |        0 1  0 0|
|         0 0 -e 0|   |         0 0 -e 0|   |        0 0 -i 0|
|         0 0  0 e|   |         0 0  0 e|   |        0 0  0 i|


       ------*-- T --*--
TXT' = - T --x-- T' -x--

|1 0    |   |1 0    |   |1  0    |   |1 0    |   |1 0    |   |1  0    |   |1 0    |
|0 e    | * |0 1    | * |0 -e    | * |0 1    | = |0 e    | * |0 -e    | = |0 1    |
|    1 0|   |    0 1|   |     e 0|   |    0 1|   |    0 1|   |     0 e|   |    1 0|
|    0 e|   |    1 0|   |     0 1|   |    1 0|   |    e 0|   |     1 0|   |    0 i|


ICX * TXT * ICX * TXT * TXT' =

|1 0             |   |1 0            |   |1 0             |
|0 1             |   |0 1            |   |0 1             |
|    1 0         |   |    1 0        |   |    1 0         |
|    0 1         | * |    0 1        | = |    0 1         |
|        1 0     |   |        1 0    |   |        1 0     |
|        0 1     |   |        0 1    |   |        0 1     |
|            -i 0|   |            i 0|   |            1  0|
|             0 i|   |            0 i|   |            0 -1|


H * (ICX * TXT)^2 * TXT' * H

|+ +            |   |1 0             |   |+ +            |   |+ +            |   |+ +            |   |1 0            |
|+ -            |   |0 1             |   |+ -            |   |+ -            |   |+ -            |   |0 1            |
|    + +        |   |    1 0         |   |    + +        |   |    + +        |   |    + +        |   |    1 0        |
|    + -        | * |    0 1         | * |    + -        | = |    + -        | * |    + -        | = |    0 1        |
|        + +    |   |        1 0     |   |        + +    |   |        + +    |   |        + +    |   |        1 0    |
|        + -    |   |        0 1     |   |        + -    |   |        + -    |   |        + -    |   |        0 1    |
|            + +|   |            1  0|   |            + +|   |            + -|   |            + +|   |            0 1|
|            + -|   |            0 -1|   |            + -|   |            + +|   |            + -|   |            1 0|
```


Given a conditional Uy for Uy such that produces (-1)^y * |p>, determine y using a network with at most two Hadamard gates.

```
|0> -- H --*-- H -- |y>
           |
|0> ------ Uy ----- |0>

Y=(-1)^y

|1  0  1  0|   |1 0 0 0|   |1 0  1  0|         |1 0  Y  0|   |1 0  1  0|         |1+Y   0 1-Y   0|
|0  1  0  1| * |0 1 0 0| * |0 1  0  1| * 1/2 = |0 1  0  Y| * |0 1  0  1| * 1/2 = |  0 1+Y   0 1-Y| * 1/2
|1  0 -1  0|   |0 0 Y 0|   |1 0 -1  0|         |1 0 -Y  0|   |1 0 -1  0|         |1-Y   0 1+Y   0|
|0  1  0 -1|   |0 0 0 Y|   |0 1  0 -1|         |0 1  0 -Y|   |0 1  0 -1|         |  0 1-Y   0 1+Y|

So for y=0 we get:

Y=1

|1 0 0 0|
|0 1 0 0|
|0 0 1 0|
|0 0 0 1|

and for y=1 we get:

Y=-1:

|0 0 1 0|
|0 0 0 1|
|1 0 0 0|
|0 1 0 0|

Which is:

(H x I) * CUy * (H x I) |0p> = (H x I) * CUy * (H|0> x |p>)
                             = (H x I) * CUy * 1/sqrt(2) * (|0p> + |1p>)
                             = (H x I) * 1/sqrt(2) * (|0p> + Y*|1p>)
                             = 1/sqrt(2) * (H|0> + Y*H|1>) x |p>
                             = 1/2 * (|0p> + |1p>) + Y/2 * (|0p> - |1p>)
                             = (1+Y)/2 * |0p> + (1-Y)/2 * |1p>

So we can fit whatever on input as p, and 0 as the first bit. Then measure the first bit. It will be equal to y.
```

I had a hunch we should try that configuration first. Can we try a different network?

```
|0> -- H --*---
           |
|0> -- H --Uy--

|1  1  1  1|   |1 0 0 0|         |1  1  Y  Y|
|1 -1  1 -1| * |0 1 0 0| * 1/2 = |1 -1  Y -Y| * 1/2
|1  1 -1 -1|   |0 0 Y 0|         |1  1 -Y -Y|
|1 -1 -1  1|   |0 0 0 Y|         |1 -1 -Y  Y|
```
